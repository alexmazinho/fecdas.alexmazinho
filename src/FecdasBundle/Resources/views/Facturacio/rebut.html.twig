{# src/Fecdas/PartesBundle/Resources/views/Page/rebut.html.twig #}
{% extends 'FecdasBundle::layout.html.twig' %}

{% form_theme form 'FecdasBundle:Includes:formtheming.html.twig' %}

{% block stylesheets %}
	
	<link href="{{ asset('css/jquery.datetimepicker.css') }}" type="text/css" rel="stylesheet" />
	
	{{ parent() }}
{% endblock %}

{% block title %}Aplicació gestió FECDAS. Gestió de rebut i ingressos{% endblock %}

{% block body %}
    <header>
        <h1><a href="{{ path('FecdasBundle_ingresos') }}">Llistat d'ingressos i rebuts</a> > Rebut</h1>
    </header>
    
    <div class="form-row clearfix">
		<div class="buttons-top buttons-top-nous">
			<div id="rebut-to-pdf" class="button-top">
				<a href="{{ path('FecdasBundle_rebuttopdf', { 'id': rebut.id}) }}" alt="PDF Rebut" title="PDF Rebut">
						<i class="fa fa-file-pdf-o fa-2x red"></i></a>
			</div>
		</div>	
	</div>
	{% include 'FecdasBundle:Includes:messages.html.twig' %}
	
	<form id="formrebut" action="{{ path('FecdasBundle_editarrebut') }}" method="post" {{ form_enctype(form) }}  class="appform">
		<div class="row">
			{{ form_widget(form.id) }}{{ form_widget(form.num) }}
			 <div class="col-md-3">
			 	<div class="form-group">
					<label>Club</label>
					<div id="formrebut-club"  class="">
						{{ form_widget(form.club, { 'attr': {'class': 'form-control form-control-left'} }) }}
					</div>{{ form_errors(form.club) }}
				</div>
			 </div>
			 <div class="col-md-2">
			 	<div class="form-group">
					{{ form_label(form.numrebut, 'Núm. rebut') }}
					<div id="formrebut-num"  class="">
						{{ form_widget(form.numrebut, { 'attr': {'class': 'form-control form-control-center'} }) }}
					</div>{{ form_errors(form.numrebut)  }}
				</div>
			 </div>
			 <div class="col-md-2">
				<div class="form-group">
					{{ form_label(form.import, 'Import') }}
					<div id="formrebut-totalsuma"  class="input-group ">
						{{ form_widget(form.import, { 'attr': {'class': 'form-control form-control-center'} }) }}
						<span class="input-group-addon"><i class="fa fa-euro"></i></span>
					</div>{{ form_errors(form.import)  }}
				</div>
			 </div>
			 <div class="col-md-5">
			 	<div class="form-group">
					{{ form_label(form.comptabilitat, 'Codi comptabilitat') }}
					<div id="formrebut-comptabilitat"  class="">
						{{ form_widget(form.comptabilitat, { 'attr': {'class': 'form-control form-control-left'} }) }}
					</div>{{ form_errors(form.comptabilitat)  }}
				</div>
			 </div>
			 <div class="col-md-3">
				<div class="form-group">
					{{ form_label(form.datapagament, 'Data de pagament') }}
					<div id="formproducte-databaixa" class="input-group">
		  				<span class="input-group-addon">Pagat</span>
						{{ form_widget(form.datapagament, { 'attr': {'class': 'form-control form-control-center formtime-calendar'} }) }}
						<span class="input-group-addon input-group-addon-icon open-calendar"><span class="fa fa-calendar fa-1x"></span></span>
					</div>{{ form_errors(form.datapagament)  }}
				</div>
			 </div>
			 <div class="col-md-2">
				<div class="form-group">
					{{ form_label(form.dadespagament, 'Dades pagament') }}
					<div id="formrebut-dadespagament">
						{{ form_widget(form.dadespagament, { 'attr': {'class': 'form-control form-control-left'} }) }}
					</div>{{ form_errors(form.dadespagament)  }}
				</div>
			 </div>
			 <div class="col-md-3">
				<div class="form-group">
					{{ form_label(form.tipuspagament, 'Tipus de pagament') }}
					<div id="formrebut-tipuspagament"  class="input-group ">
						<span class="input-group-addon"><i class="fa fa-university"></i></span>
						{{ form_widget(form.tipuspagament, { 'attr': {'class': 'form-control form-control-left'} }) }}
					</div>{{ form_errors(form.tipuspagament)  }}
				</div>
			 </div>

			 <div class="col-md-3 col-md-offset-1">
				<div class="form-group">
					{{ form_label(form.dataanulacio, 'Data d\'anul·lació') }}
					<div id="formrebut-dataanulacio" class="input-group">
		  				<span class="input-group-addon">Anul·lat</span>
						{{ form_widget(form.dataanulacio, { 'attr': {'class': 'form-control form-control-center formtime-calendar'} }) }}
						<span class="input-group-addon input-group-addon-icon open-calendar"><span class="fa fa-calendar fa-1x"></span></span>
					</div>{{ form_errors(form.dataanulacio)  }}
				</div>
			 </div>
			 <div class="col-md-6">
			  	<div class="form-group">
			    	{{ form_label(form.comanda, 'Comanda') }}
			    	<div class="label-actions accions-comanda">
					{% if rebut.comanda is null %}
						<i class="fa fa-search fa-1x grey"></i>
					{% else %}
						<a id="editar-comanda" class="link" href="{{ path('FecdasBundle_editarcomanda', {'id': rebut.comanda.id }) }}"  title="Editar comanda" alt="Editar comanda">
							<i class="fa fa-search fa-1x blue"></i></a>
					{% endif %}
					</div>
			    	<div id="formrebut-comanda">
						{{ form_widget(form.comanda, { 'attr': {'class': 'form-control form-control-left'} }) }}
					</div>
				</div>
			 </div>
			 <div class="col-md-6">
			 	<div class="form-group">
			 		{{ form_label(form.comentari, 'Comentari') }}
					<div id="formrebut-comentari"  class="">
					{{ form_widget(form.comentari, { 'attr': {'class': 'form-control'} }) }}
					</div>
				</div>{{ form_errors(form.comentari)  }}
			 </div> 
			 <div class="col-md-2">
				<button type="submit" id="formrebut-desar" class="btn btn-default btn-lg"><i class="fa fa-save"></i> Desar</button>
			 </div>
		</div>
		
		<div id="formrebut-rest" class="sr-only">{{ form_rest(form) }}</div>
		
		<div id="error" class="sms-notice" style="display:none"> </div>
		
		<div class="row"></div>
    </form>

{% endblock %}

{% block javascripts %}

	{{ parent() }}

	<!-- Datetime plugin's. http://xdsoft.net/jqplugins/datetimepicker/ -->
	<script src="{{ asset('js/jquery.datetimepicker.js') }}" type="text/javascript"></script>

	<script type="text/javascript">

		$(document).ready(function(){
			setMenuActive("menu-admrebut");

			$("select#rebut_club").select2({
				minimumInputLength: 2,
				allowClear: true,
			});

			$("select#rebut_comanda").select2({
				minimumInputLength: 2,
				allowClear: true,
			});

			$("select#rebut_comanda").change( function() {
				var id = $(this).val();
				

				var url = "{{ path('FecdasBundle_editarcomanda', {'id': '__COMANDA__' }) }}";
				url = url.replace("__COMANDA__", id);

				$('.accions-comanda').html("<a id='editar-comanda' class='link' href='"+url+"' title='Editar comanda' alt=Editar comanda'> \
											<i class='fa fa-search fa-1x blue'></i></a>");
			}); 
			
			var current = new Date();
			
			var mindate = new Date (current.getFullYear(), current.getMonth() - 2, current.getDay());
			var maxdate = new Date (current.getFullYear(), current.getMonth() + 1, current.getDay());

			initDateTimePicker ( 
				$( '#rebut_datapagament' ), 
				mindate, 
				current, 
				current, 
				'datapagament-picker', 
				false,
				''
			);

			initDateTimePicker ( 
				$( '#rebut_dataanulacio' ), 
				mindate, 
				current, 
				current, 
				'dataanulacio-picker', 
				false,
				''
			);
			
		});
		
	</script>


{% endblock %}


{# src/Fecdas/PartesBundle/Resources/views/Page/factura.html.twig #}
{% extends 'FecdasBundle::layout.html.twig' %}

{% form_theme form 'FecdasBundle:Includes:formtheming.html.twig' %}

{% block stylesheets %}
	
	<link href="{{ asset('css/jquery.datetimepicker.css') }}" type="text/css" rel="stylesheet" />
	
	{{ parent() }}
{% endblock %}

{% block title %}Aplicació gestió FECDAS. Gestió de factures{% endblock %}

{% block body %}
    <header>
        <h1><a href="{{ path('FecdasBundle_comandes', { 'sort': 'c.id', 'direction':'desc' }) }}">Llistat de comandes</a> > Factura</h1>
    </header>
    
    <div class="form-row clearfix">
		<div class="buttons-top buttons-top-nous">
			<div id="factura-to-pdf" class="button-top">
				<a href="{{ path('FecdasBundle_facturatopdf', { 'id': factura.id}) }}" alt="Factura" title="Factura">
						<i class="fa fa-file-pdf-o fa-2x red"></i></a>
			</div>
		</div>	
	</div>
	
	{% include 'FecdasBundle:Includes:messages.html.twig' %}    
	<form id="formfactura" action="{{ path('FecdasBundle_editarfactura') }}" method="post" {{ form_enctype(form) }}  class="appform">
		<div class="row">
			{{ form_widget(form.id) }}
			 <div class="col-md-4">
			 	<div class="form-group">
					<div id="formfactura-comanda"  class="input-group input-group-button-right">
						<span class="input-group-addon">Comanda</span>
						{{ form_widget(form.comandatext, { 'attr': {'class': 'form-control form-control-center form-control-button-right'} }) }}
						{% if factura.comanda is not null %}
							<a id="veure-comanda" class="link" href="{{ path('FecdasBundle_editarcomanda', {'id': factura.comanda.id }) }}"  title="Veure comanda" alt="Veure comanda">
								<i class="fa fa-search fa-1x blue"></i></a>
						{% endif %}
					</div>{{ form_errors(form.comandatext)  }}
				</div>
			 </div>
			 <div class="col-md-5">
			 	<div class="form-group">
					<div id="formfactura-club"  class="input-group  input-group-button-right">
						<span class="input-group-addon">Club</span>
						{{ form_widget(form.club, { 'attr': {'class': 'form-control form-control-center'} }) }}
						{% if factura.comanda is not null and factura.comanda.club is not null %}
							<a id="veure-club" class="link" href="{{ path('FecdasBundle_club', {'codiclub': factura.comanda.club.codi }) }}"  title="Veure club" alt="Veure club">
							<i class="fa fa-search fa-1x blue"></i></a>
						{% endif %}
					</div>{{ form_errors(form.club)  }}
				</div>
			 </div>
			 {{ form_widget(form.num) }}
			 <div class="col-md-3">
			 	<div class="form-group">
				    <div id="formfactura-numfactura" class="input-group">
						<div class="input-group"><div class="input-group-addon">Número</div>{{ form_widget(form.numfactura, { 'attr': {'class': 'form-control form-control-center'} }) }}</div>
					</div>{{ form_errors(form.numfactura)  }}
				</div>
			 </div>
			 <div class="col-md-3">
				<div class="form-group">
					<label></label>
					<div id="formfactura-datafactura" class="input-group">
		  				<span class="input-group-addon">Data</span>
						{{ form_widget(form.datafactura, { 'attr': {'class': 'form-control form-control-center formtime-calendar'} }) }}
						<span class="input-group-addon input-group-addon-icon open-calendar"><span class="fa fa-calendar fa-1x"></span></span>
					</div>{{ form_errors(form.datafactura)  }}
				</div>
			 </div>
			 <div class="col-md-3">
				<div class="form-group">
					<label></label>
					<div id="formfactura-import"  class="input-group ">
						<span class="input-group-addon">Import</span>
						{{ form_widget(form.import, { 'attr': {'class': 'form-control form-control-right'} }) }}
						<span class="input-group-addon"><i class="fa fa-euro"></i></span>
					</div>{{ form_errors(form.import)  }}
				</div>
			 </div>
			 <div class="col-md-3">
				<div class="form-group">
					<label></label>
					<div id="formfactura-datapagament" class="input-group">
		  				<span class="input-group-addon">Pagada</span>
						{{ form_widget(form.datapagament, { 'attr': {'class': 'form-control form-control-center formtime-calendar'} }) }}
						<span class="input-group-addon input-group-addon-icon open-calendar"><span class="fa fa-calendar fa-1x"></span></span>
					</div>{{ form_errors(form.datapagament)  }}
				</div>
			 </div>
			 <div class="col-md-3">
				<div class="form-group">
					<label></label>
					<div id="formfactura-dataanulacio" class="input-group">
		  				<span class="input-group-addon">Anulada</span>
						{{ form_widget(form.dataanulacio, { 'attr': {'class': 'form-control form-control-center formtime-calendar'} }) }}
						<span class="input-group-addon input-group-addon-icon open-calendar"><span class="fa fa-calendar fa-1x"></span></span>
					</div>{{ form_errors(form.dataanulacio)  }}
				</div>
			 </div>
			 <div class="col-md-6">
				<div class="form-group">
					<label></label>
					<div id="formfactura-descripcio"  class="input-group ">
			  			<span class="input-group-addon">Concepte</span>
						{{ form_widget(form.concepte, { 'attr': {'class': 'form-control'} }) }}
					</div>
				</div>
			 </div>
		</div>
		<div class="row">
			 <div class="col-md-2">
				<button type="submit" id="formfactura-desar" class="btn btn-default btn-lg"><i class="fa fa-save"></i> Desar</button>
			 </div>	
		</div>
		
		<div id="formfactura-rest" class="sr-only">{{ form_rest(form) }}</div>
		
		<div id="error" class="sms-notice" style="display:none"> </div>
		
		<div class="row"></div>
    </form>

{% endblock %}

{% block javascripts %}

	{{ parent() }}

	<!-- Datetime plugin's. http://xdsoft.net/jqplugins/datetimepicker/ -->
	<script src="{{ asset('js/jquery.datetimepicker.js') }}" type="text/javascript"></script>

	<script type="text/javascript">

		$(document).ready(function(){
			setMenuActive("menu-admcomanda");

			var current = new Date();
			
			var mindate = new Date (current.getFullYear(), current.getMonth() - 2, current.getDay());
			var maxdate = new Date (current.getFullYear(), current.getMonth() + 1, current.getDay());

			initDateTimePicker ( 
				$( '#factura_datafactura' ), 
				mindate, 
				maxdate, 
				current, 
				'datafactura-picker', 
				false,
				''
			);
			
			initDateTimePicker ( 
				$( '#factura_datapagament' ), 
				mindate, 
				current, 
				current, 
				'datapagament-picker', 
				false,
				''
			);

			initDateTimePicker ( 
				$( '#factura_dataanulacio' ), 
				mindate, 
				current, 
				current, 
				'dataanulacio-picker', 
				false,
				''
			);
			
		});
		
	</script>


{% endblock %}


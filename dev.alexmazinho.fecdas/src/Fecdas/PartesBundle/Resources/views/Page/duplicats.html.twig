{% extends 'FecdasPartesBundle::layout.html.twig' %}

{% block javascriptshead %}
 	{{ parent() }}
	<script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/jquery.effects.core.js"></script>
	<script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/jquery.effects.slide.js"></script>
   	 {{ form_javascript(form) }}
{% endblock %}

{% block title %}Aplicació gestió FECDAS. Petició de duplicats de carnets{% endblock %}

{% block body %}
	<header>
        <h1>Petició de duplicats</h1>
    </header>

   	<form id="formduplicats" action="{{ path('FecdasPartesBundle_duplicats') }}" method="post" {{ form_enctype(form) }}  class="appform">
   		<div class="form-row clearfix">
   			<div id="formduplicats-persona" class="form-left">
				{{ form_widget(form.persona, { 'attr': {'class': 'forminput-inside ', 'style': 'width:100%'} }) }}
			</div> 
			<div id="formduplicats-carnets" class="form-left">
				{{ form_widget(form.carnets, { 'attr': {'class': 'formfield-outside'} }) }}
			</div>
			<div id="formduplicats-titols" class="form-left"></div>
		</div>
		<div id="formduplicats-dades" class="form-row clearfix"></div>
    </form>

    {% for flashMessage in app.session.flashbag.get('error-notice') %}
    <div class="sms-notice">
		{{ flashMessage }}
  	</div>	
	{% endfor %}
    
	<div id="llista-duplicats">
		<div class="table-header">	
		   	<div id="list-header">
		   		<div id="header-duplicatid" class="col-listheader">id</div>
		   		<div id="header-duplicatpeticio" class="col-listheader">Petició<span class="listheader-order"></span></div>
		   		<div id="header-duplicatdni" class="col-listheader">DNI<span class="listheader-order"></span></div>
		   		<div id="header-duplicatnom" class="col-listheader">Nom<span class="listheader-order"></span></div>
		   		<div id="header-duplicatcognoms" class="col-listheader">Cognoms<span class="listheader-order"></span></div>
		   		<div id="header-duplicatcarnet" class="col-listheader">Carnet<span class="listheader-order"></span></div>
		   		<div id="header-duplicatimpressio" class="col-listheader">Imprès<span class="listheader-order"></span></div>
		   		<div id="header-duplicatextra" class="col-listheader">Altres dades<span class="listheader-order"></span></div>
		   		<div id="header-duplicatactions" class="col-listheader listheader-noorder">&nbsp;</div>
		   	</div>
	   	</div>
		{% if duplicats|length > 0 %}
		<div class="table-scroll">
		   	<ol id="list-data">
			{% for duplicat in duplicats %}
				{% if admin == true or (admin != true and duplicat.databaixa is not null) %}
			   		<li class="data-detall">
				   		<div class="data-detall-cell duplicat-id">{{ duplicat.id }}</div>
				   		<div class="data-detall-cell duplicat-peticio"><time datetime="{{ duplicat.datapeticio|date('c') }}">{{ parte.datapeticio|date('d/m/y') }}</time></div>
				   		<div class="data-detall-cell duplicat-dni">{{ duplicat.persona.dni }}</div>
				   		<div class="data-detall-cell duplicat-nom">{{ duplicat.persona.nom }}</div>
				   		<div class="data-detall-cell duplicat-cognoms">{{ duplicat.persona.cognoms }}</div>
				   		<div class="data-detall-cell duplicat-carnet">{{ duplicat.textCarnet }}</div>
				   		<div class="data-detall-cell duplicat-impressio"><time datetime="{{ duplicat.dataimpressio|date('c') }}">{{ parte.dataimpressio|date('d/m/y') }}</time></div>
				   		<div class="data-detall-cell duplicat-extra">{{ duplicat.infoLlistat }}</div>
				   		<div class="data-detall-cell duplicat-actions">
				   			<a class="llicencia-renovar" href="">
			   						<img src="{{ asset('images/icon-albara.png') }}" alt="Veure rebut" title="Veure rebut" width="23px"></a>
				   			{% if admin == true %}
			   				<a class="llicencia-renovar" href="{{ path('FecdasPartesBundle_anularpeticio', { 'id': duplicat.id }) }}">
			   						<img src="{{ asset('images/icon-remove.png') }}" alt="Anular petició" title="Anular petició" width="23px"></a>
			   				{% endif %}
			   			</div>
			   		</li>
			   	{% endif %}
			{% endfor %}
			</ol>
		</div>
	   	{% else %}
	        <div class="sms-notice">Sense peticions</div>
	    {% endif %}
	</div>
{% endblock %}

{% block javascripts %}

{{ parent() }}

<script type="text/javascript">

$(document).ready(function(){
	setMenuActive("menu-duplicats");

	actionsFormDuplicats("{{ path('FecdasPartesBundle_duplicatsform') }}");

	hoverPortada($(".image-upload"));
	
	$(".galeria-upload").click(function() {
		alert("");
		$('#form_foto').click();
	});

	$('#form_foto').imagePreview({ selector : '.galeria-upload', multiple: false, textover: 'Canviar imatge' });
	
	sortLlista("col-listheader", "list-data");

	var tableScroll = $('.table-scroll');
	if (tableScroll.hasOverflowY()) {
		$('.table-scroll').css({"width":"101.5%"});
	}

});

</script>


{% endblock %}
